{% extends "base.html.twig" %}

{% block body %}
    <div class="row h-50 col-12">
        <h2 class="position-absolute col-12 text-center bg-white font-MF p-2" style="margin-top:15%;">{{ figure.name }}</h2>
        <img src="{{ asset('uploads/home/' ~ figure.image) }}" alt="TrickSnow" class="mx-auto" height="500" width="auto">
    </div>
    <div class="row position-absolute col-12 justify-content-end" style="top:60px;">
        <a href="{{ path('blog_edit', {'id': figure.id}) }}" class="p-2">&#128394;</a>
        <a href="{{ path('delete', {'entity': 'figure', 'id': figure.id}) }}" onclick="return confirm('Etes-vous sur de vouloir supprimer cette figure ?')" class="p-2">
            &#128465;</a>
    </div>
    <div class="text-justify col-9 mx-auto">
        {{ figure.content }}
    </div>
    <div class="row overflow-auto justify-content-start">
        {% for media in medias %}
            <article class="mt-nav row col-md-2 h-25 m-3" id="{{media.id}}">
                {% if media.type == 'image' %}
                    <img src="{{ media.file }}" alt="" width="100%" height="150px" class="mt-3 border border-primary">
                {% else %}
                    <iframe src="{{ media.file }}" alt="" width="100%" height="150px" class="mt-3 border border-primary"></iframe>
                {% endif %}
                <div class="border border-primary row w-100 justify-content-between ml-0">
                    {% if app.user %}
                        <a href="{{ path('delete', {'entity': 'media', 'id': media.id}) }}" onclick="return confirm('Etes-vous sur de vouloir supprimer cette figure ?')">
                            &#128465;</a>
                    {% endif %}
                </div>
            </article>
        {% endfor %}
    </div>
    <div class="row justify-content-lg-center border-bottom p-3">
        {% if figure.dateLastUpdate is empty %}
            <div class="metadata rounded p-3 m-2 bg-primary text-white">Ecrit le
                {{ figure.dateCreated | date('d/m/Y')}}
                à
                {{ figure.dateCreated | date('H:i')}}
            </div>
        {% else %}
            <div class="metadata rounded p-3 m-2 bg-primary text-white">Dernière modification le
                {{ figure.dateLastUpdate | date('d/m/Y')}}
                à
                {{ figure.dateLastUpdate | date('H:i')}}
            </div>
        {% endif %}
        <div class="row rounded p-3 m-2 bg-primary text-white">
            <div>Auteur :</div>
            <div class="font-MF">{{ figure.user.username }}</div>
        </div>
        <div class=" rounded p-3 m-2 bg-primary text-white">
            Catégory :
        </div>
    </div>

    <section id="commentaires">
        {% if app.user %}
            {{ form_start(formForum) }}
            <div class="row justify-content-center">
                <div class="col-lg-6 p-0 mt-3">{{ form_row(formForum.content) }}</div>
                <div class="col-lg-3 p-0 mt-3">
                    <button type="submit" class="btn btn-success">
                        Laissez un commentaire
                    </button>
                </div>
            </div>
            {{ form_end(formForum) }}
        {% else %}
            <h2>
                Vous ne pouvez pas Répondre si vous n'êtes pas connecté !</h2>
            <a href="{{path('security_login')}}" class="btn btn-primary">
                Connexion
            </a>
        {% endif %}
        {% for forum in figure.forums %}
            <div class="comment">
                <div class="row">
                    <div class="col-3">
                        {{ forum.user.username }}
                        (<small>{{ forum.dateCreated | date('d/m/Y')}}</small>)
                        <div class="col">
                            {{ forum.content | raw }}</div>
                    </div>
                </div>
            </div>
        {% endfor %}
        {% if figure.forums|length == 0 %}
            <div class="text-center text-danger h3">
                Aucune réponse sur cette figure
            </div>
        {% elseif figure.forums|length == 1 %}
            <h2>{{ figure.forums | length }}
                Réponse :
            </h2>
        {% else %}
            <h2>{{ figure.forums | length }}
                Réponses :
            </h2>
        {% endif %}

    </section>
{% endblock %}
